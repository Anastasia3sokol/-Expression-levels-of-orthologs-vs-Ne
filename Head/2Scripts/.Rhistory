hist(df$number_of_species)
dev.off()
results <- read.table('../../Body/3_Results/linear.regression.kn.ks.vs.generation.length.hsp.like.genes.mammals.txt')
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept all hsp genes\n n=73')
results <- read.table('../../Body/3_Results/linear.regression.kn.ks.vs.generation.length.all.hsp.mammals.txt')
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept all hsp genes\n n=73')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
plot(log10(results[,'intercept']), log10(results[,'slopes']),
xlab = 'lg_intecept', ylab = 'lg_slope')
points(log10(results[results$genes == 'dN.dS_ENSG00000096384','intercept']), log10(results[results$genes == 'dN.dS_ENSG00000096384','slopes']), col = 'red', pch = 19)
results[results$genes == 'dN.dS_ENSG00000096384','intercept']
log10(results[results$genes == 'dN.dS_ENSG00000096384','intercept'])
cart2pol <- function(x, y) {
r <- sqrt(x^2 + y^2)
t <- atan(y/x)
c(r,t)
}
plot(cart2pol(results[,'intercept'], results[,'slopes']),
xlab = 'intecept', ylab = 'slope')
points(cart2pol(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes']), col = 'red', pch = 19)
title('Slope vs intercept all hsp genes\n n=73')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
cart2pol <- function(x, y) {
r <- sqrt(x^2 + y^2)
t <- atan(y/x)
return(c(r,t))
}
plot(cart2pol(results[,'intercept'], results[,'slopes']),
xlab = 'intecept', ylab = 'slope')
points(cart2pol(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes']), col = 'red', pch = 19)
plot(cart2pol(results[,'intercept'], results[,'slopes']),
xlab = 'intecept', ylab = 'slope')
getSteps <- function(x,y) {
d <- diff(complex(real = x, imaginary = y))
data.frame(size = Mod(d),
angle = c(NA, diff(Arg(d)) %% (2*pi)) * 360/(2*pi))
}
plot(getSteps(results[,'intercept'], results[,'slopes']),
xlab = 'intecept', ylab = 'slope')
getSteps(results[,'intercept'], results[,'slopes'])
polar(getSteps(results[,'intercept'], results[,'slopes']),
xlab = 'intecept', ylab = 'slope')
install.packages('pracma v1.9.9')
library(dplyr)
install.packages('dplyr')
View(cart2pol)
log10(0.0005)
log10(0.00005)
log10(0.000000005)
log10(-0.000000005)
library(dplyr)
cart2pol(results[,'intercept'], results[,'slopes'])
rm(list=ls(all=TRUE))
results <- read.table('../../Body/3_Results/hsp.like.genes.linear.model.results.kn.ks.vs.generation.length.mammals.right.way.txt')
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
rm(list=ls(all=TRUE))
df <- read.table('../../Body/3_Results/hsp.like.genes.linear.model.results.kn.ks.vs.generation.length.mammals.right.way.txt')
par(mfrow = c(1,2))
hist(df$slopes)
hist(df$p_val_slope)
hist(df$intercept)
hist(df$p_val_intercept)
par(mfrow = c(1,1))
hist(df$number_of_species)
pdf('../../Body/4_Figures/.hsp.like.genes.linear.model.parameters.dist.pdf')
par(mfrow = c(1,2))
hist(df$slopes)
hist(df$p_val_slope)
hist(df$intercept)
hist(df$p_val_intercept)
par(mfrow = c(1,1))
hist(df$number_of_species)
dev.off()
View(df)
hist(df$R_sq)
hist(df$R_sq_adj)
hist(df$residual_std_err)
hist(df$R_sq)
pdf('../../Body/4_Figures/.hsp.like.genes.linear.model.parameters.dist.pdf')
par(mfrow = c(1,2))
hist(df$slopes)
hist(df$p_val_slope)
hist(df$intercept)
hist(df$p_val_intercept)
par(mfrow = c(1,1))
hist(df$number_of_species)
hist(df$R_sq)
hist(df$R_sq_adj)
hist(df$residual_std_err)
dev.off()
cor.test(results[results$p_val_slope < 0.01,'intercept'], results[results$p_val_slope < 0.01,'slopes'])
results <- read.table('../../Body/3_Results/hsp.like.genes.linear.model.results.kn.ks.vs.generation.length.mammals.right.way.txt')
cor.test(results[results$p_val_slope < 0.01,'intercept'], results[results$p_val_slope < 0.01,'slopes'])
plot(results[results$p_val_slope < 0.01,'intercept'], results[results$p_val_slope < 0.01,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
plot(results[results$p_val_slope < 0.01,'intercept'], results[results$p_val_slope < 0.01,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
lines(x = c(0,1),y =c(0,0), col = 'blue')
title('Slope vs intercept genes like hsp90, n = 50, p_value_slope < 0.01')
legend(x = 20, y = 0.0065, legend = 'hsp90', col = 'red', pch = 19)
plot(results[results$p_val_slope < 0.05,'intercept'], results[results$p_val_slope < 0.05,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
lines(x = c(0,1),y =c(0,0), col = 'blue')
legend(x = 37, y = 0.0056, legend = 'hsp90', col = 'red', pch = 19)
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
View(results)
lines(x = c(0,1),y =c(0,0), col = 'blue')
lines(x = c(0,100),y =c(0,0), col = 'blue')
title('Slope vs intercept genes like hsp90, n = 177')
legend(x = 37, y = 0.0056, legend = 'hsp90', col = 'red', pch = 19)
pdf('../../Body/4_Figures/hsp.like.genes.linear.model.slopes.right.way.pdf')
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for genes closed to hsp90 (red)\n n = 84, , p_value_slope < 0.05')
legend(x = 50, y = 0.005,legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for genes closed to hsp90 (red)\n n = 84, p_value_slope < 0.05')
legend(x = 10, y = 35, legend = 'hsp90', col = 'red', pch = 19)
plot(results[results$p_val_slope < 0.05,'intercept'], results[results$p_val_slope < 0.05,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
lines(x = c(0,1),y =c(0,0), col = 'blue')
title('Slope vs intercept genes like hsp90, n = 84, p_value_slope < 0.05')
legend(x = 37, y = 0.0056, legend = 'hsp90', col = 'red', pch = 19)
##########
boxplot(results[results$p_val_slope < 0.01,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for genes closed to hsp90 (red)\n n = 50, p_value_slope < 0.01')
legend(x = 50, y = 0.005,legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.01,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for genes closed to hsp90 (red)\n n = 50, p_value_slope < 0.01')
legend(x = 10, y = 35, legend = 'hsp90', col = 'red', pch = 19)
plot(results[results$p_val_slope < 0.01,'intercept'], results[results$p_val_slope < 0.01,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
lines(x = c(0,1),y =c(0,0), col = 'blue')
title('Slope vs intercept genes like hsp90, n = 50, p_value_slope < 0.01')
legend(x = 20, y = 0.0065, legend = 'hsp90', col = 'red', pch = 19)
#do we need fiter significant p-val??
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
lines(x = c(0,100),y =c(0,0), col = 'blue')
title('Slope vs intercept genes like hsp90, n = 177')
legend(x = 37, y = 0.0056, legend = 'hsp90', col = 'red', pch = 19)
dev.off()
source('~/Desktop/HSP/HSP/Head/2Scripts/all.hsp.linear.model.slopes.R')
rm(list=ls(all=TRUE))
df <- read.table('../../Body/2_Derived/kn.ks.all.hsp.txt')
df[df == 'n/a'] <- NA
df[, -1] <- sapply(df[, -1], as.vector)
df[, -1] <- sapply(df[, -1], as.numeric)
#delete columns with too much NA
todrop <- c()
for (col in colnames(df[,-c(1,96)])) {
if (sum(is.na(df[,col])) > 35) {
todrop <- c(todrop, col)
}
}
df <- df[, !(names(df) %in% todrop)]
#saving linear regression parameters
slopes <- c()
p_val_slope <- c()
intercept <- c()
p_val_intercept <- c()
R_sq <- c()
R_sq_adj <- c()
residual_std_err <- c()
number_of_species <- c()
genes <- colnames(df)[-c(1,75)]
for (gene in genes) {
#a <- na.omit(df[,c(gene, 'Generation_Length')])
if ((length(df[,gene]) - sum(is.na(df[,gene]))) < 10){
print(gene)
genes <- genes[genes != gene]
next
}
a <- na.omit(df[,c("Species", gene, 'Generation_Length')])
species <- a[,'Species']
number_of_species <- c(number_of_species, length(species))
lg <- lm(a[,gene]~a[,'Generation_Length'], data = a)
sum <- summary(lg)
b <- sum$coefficients
slopes <- c(slopes, b[2,1])
p_val_slope <- c(p_val_slope, b[2,4])
intercept <- c(intercept, b[1,1])
p_val_intercept <- c(p_val_intercept, b[1,4])
R_sq <- c(R_sq, sum$r.squared)
R_sq_adj <- c(R_sq_adj, sum$adj.r.squared)
residual_std_err <- c(residual_std_err, sum$sigma)
}
#table with linear regression parameters
results <- data.frame(genes, slopes, intercept, p_val_slope, p_val_intercept, number_of_species, R_sq, R_sq_adj, residual_std_err)
write.table(results, '../../Body/3_Results/linear.regression.kn.ks.vs.generation.length.all.hsp.mammals.txt'            )
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept all hsp genes\n n=73')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
rm(list=ls(all=TRUE))
df <- read.table('../../Body/3_Results/linear.regression.kn.ks.vs.generation.length.all.hsp.mammals.txt')
hist(df$R_sq)
par(mfrow = c(1,2))
hist(df$R_sq)
hist(df$R_sq_adj)
hist(df$residual_std_err)
pdf('../../Body/4_Figures/all.hsp.linear.model.parameters.dist.pdf')
par(mfrow = c(1,2))
hist(df$slopes)
hist(df$p_val_slope)
hist(df$intercept)
hist(df$p_val_intercept)
par(mfrow = c(1,1))
hist(df$number_of_species)
par(mfrow = c(1,2))
hist(df$R_sq)
hist(df$R_sq_adj)
par(mfrow = c(1,1))
hist(df$residual_std_err)
dev.off()
cor.test(results[results$p_val_slope < 0.01,'intercept'], results[results$p_val_slope < 0.01,'slopes'])
###drawing plots
results <- read.table('../../Body/3_Results/hsp.like.genes.linear.model.results.kn.ks.vs.generation.length.mammals.right.way.txt')
cor.test(results[results$p_val_slope < 0.01,'intercept'], results[results$p_val_slope < 0.01,'slopes'])
cor.test(results[,'intercept'], results[,'slopes'])
rm(list=ls(all=TRUE))
df <- read.table('../../Body/3_Results/hsp.like.genes.linear.model.results.kn.ks.vs.generation.length.mammals.right.way.txt')
pdf('../../Body/4_Figures/.hsp.like.genes.linear.model.parameters.dist.pdf')
par(mfrow = c(1,2))
hist(df$slopes)
hist(df$p_val_slope)
hist(df$intercept)
hist(df$p_val_intercept)
par(mfrow = c(1,1))
hist(df$number_of_species)
par(mfrow = c(1,2))
hist(df$R_sq)
hist(df$R_sq_adj)
par(mfrow = c(1,1))
hist(df$residual_std_err)
dev.off()
rm(list = ls(all = T))
tissue_num <- read.table('../../Body/2_Derived/Gtex.LOE.GOE.tissues.numbers.txt')
rm(list=ls(all=TRUE))
All_best_var <- read.table('../../Body/2_Derived/All.best.vat.all.tissue.variants.outside.genes.important.columns.txt')
genes.like.hsp <- as.vector(read.table('../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')[1:300,1])
All_best_var_genes_like_hsp <- All_best_var[grepl(paste(genes.like.hsp, collapse="|"), All_best_var$cis_eQTL_id),]
#look at hsp90
All_best_var_hsp <- All_best_var_genes_like_hsp[grepl('ENSG00000096384', All_best_var_genes_like_hsp$cis_eQTL_id),]
length(All_best_var_hsp$cis_eQTL_id) == length(unique(All_best_var_hsp$cis_eQTL_id)) #TRUE 47
length(All_best_var_hsp$Tissue) == length(unique(All_best_var_hsp$Tissue)) #TRUE 47
hsp_LOE <- All_best_var_hsp[All_best_var_hsp$slope < 0, 'Assessed_Allele_Freq']
hsp_GOE <- All_best_var_hsp[All_best_var_hsp$slope > 0, 'Assessed_Allele_Freq']
x <- c(hsp_GOE, hsp_LOE)
gp = c(rep("hsp90 GOE Assessed allele freq", length(hsp_GOE)),rep("hsp90 LOE Assessed allele freq",length(hsp_LOE)))
boxplot(x ~ gp, xlab = '')
par(mfcol = c(1,1))
boxplot(x ~ gp, xlab = '')
t.test(hsp_GOE, hsp_LOE) #no difference p-value = 0.7528
# count tissues in which each unique cis-eQTL is occured
cis_eQTL_id <- as.array(unique(All_best_var_genes_like_hsp$cis_eQTL_id))
LOE_tissues <- c()
for (QTL in cis_eQTL_id){
LOE_count <- 0
LOE <- All_best_var_genes_like_hsp[(All_best_var_genes_like_hsp$cis_eQTL_id == QTL) & (All_best_var_genes_like_hsp$slope < 0),]$Tissue
LOE_count <- length(unique(LOE))
LOE_tissues <- c(LOE_tissues, LOE_count)
GOE_count <- 0
GOE <- All_best_var_genes_like_hsp[(All_best_var_genes_like_hsp$cis_eQTL_id == QTL) & (All_best_var_genes_like_hsp$slope > 0),]$Tissue
GOE_count <- length(unique(GOE))
GOE_tissues <- c(GOE_tissues, GOE_count)
}
GOE_tissues <- c()
for (QTL in cis_eQTL_id){
LOE_count <- 0
LOE <- All_best_var_genes_like_hsp[(All_best_var_genes_like_hsp$cis_eQTL_id == QTL) & (All_best_var_genes_like_hsp$slope < 0),]$Tissue
LOE_count <- length(unique(LOE))
LOE_tissues <- c(LOE_tissues, LOE_count)
GOE_count <- 0
GOE <- All_best_var_genes_like_hsp[(All_best_var_genes_like_hsp$cis_eQTL_id == QTL) & (All_best_var_genes_like_hsp$slope > 0),]$Tissue
GOE_count <- length(unique(GOE))
GOE_tissues <- c(GOE_tissues, GOE_count)
}
cis_eQTL_id <- as.vector(cis_eQTL_id)
tissue_numbers <- data.frame(cbind(cis_eQTL_id, LOE_tissues, GOE_tissues))
rm(list = ls(all = T))
tissue_num <- read.table('../../Body/2_Derived/Gtex.LOE.GOE.tissues.numbers.txt')
gene <- gsub('.*b37_','', tissue_num$cis_eQTL_id)
tissue_num <- cbind(tissue_num, gene)
LOE_tissues <- c()
View(tissue_num)
LOE_cis_eQTLs <- c()
GOE_tissues <- c()
GOE_cis_eQTLs <- c()
unique_genes <- unique(gene)
for (g in unique_genes){
#count common amount of tissues for each gene in which there is cis-eQTLs
loe_tis <- sum(tissue_num[tissue_num$gene == g,'LOE_tissues'])
goe_tis <- sum(tissue_num[tissue_num$gene == g,'GOE_tissues'])
LOE_tissues <- c(LOE_tissues,loe_tis)
GOE_tissues <- c(GOE_tissues,goe_tis)
#count common amount of unique cis-eQTLs for each gene
loe_eqtl <- dim(tissue_num[(tissue_num$gene == g) & (tissue_num$LOE_tissues > 0),])[1]
goe_eqtl <- dim(tissue_num[(tissue_num$gene == g) & (tissue_num$GOE_tissues > 0),])[1]
LOE_cis_eQTLs <- c(LOE_cis_eQTLs, loe_eqtl)
GOE_cis_eQTLs <- c(GOE_cis_eQTLs, goe_eqtl)
}
View(tissue_num)
#saving results
df <- data.frame(cbind(unique_genes, LOE_tissues, GOE_tissues, LOE_cis_eQTLs, GOE_cis_eQTLs) )
write.table(df, '../../Body/2_Derived/Gtex.LOE.GOE.tissue.ciseQTL.numbers.per.gene.txt')
plot(LOE_tissues,GOE_tissues, asp = 1, xlab = 'LOE cis-eQTL sum in all tissue', ylab = 'GOE cis-eQTL sum in all tissue')
points(LOE_tissues[which(unique_genes == 'ENSG00000096384')], GOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(40, 36, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE in all tissues')
#pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.numbers.boxplot.hsp.like.genes.pdf')
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','GOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','GOE_tissues'], names = c('hsp90', 'other genes'))
title('GOE cis-eQTL tissue number')
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','LOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','LOE_tissues'], names = c('hsp90', 'other genes'))
title('LOE cis-eQTL tissue number')
#pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.numbers.boxplot.hsp.like.genes.pdf')
par(mfraw=c(1,2))
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','GOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','GOE_tissues'], names = c('hsp90', 'other genes'))
title('GOE cis-eQTL tissue number')
#pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.numbers.boxplot.hsp.like.genes.pdf')
par(mfraw=c(1,2))
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','GOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','GOE_tissues'], names = c('hsp90', 'other genes'))
title('GOE cis-eQTL tissue number')
#pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.numbers.boxplot.hsp.like.genes.pdf')
par(mfcol =c(1,2))
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','GOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','GOE_tissues'], names = c('hsp90', 'other genes'))
title('GOE cis-eQTL tissue number')
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','LOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','LOE_tissues'], names = c('hsp90', 'other genes'))
title('LOE cis-eQTL tissue number')
View(df)
View(tissue_num)
boxplot(df[df$gene == 'ENSG00000096384','GOE_tissues'], df[df$gene != 'ENSG00000096384','GOE_tissues'], names = c('hsp90', 'other genes'))
df[df$gene == 'ENSG00000096384','GOE_tissues']
df[df$gene == 'ENSG00000096384','LOE_tissues']
df$gene == 'ENSG00000096384'
plot(df$LOE_cis_eQTLs, df$GOE_cis_eQTLs)
plot(LOE_cis_eQTLs, GOE_cis_eQTLs)
points(LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
boxplot(LOE_cis_eQTLs, GOE_cis_eQTLs, names = c('LOE', 'GOE'))
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
boxplot(GOE_tissues/LOE_tissues)
points(GOE_tissues[which(unique_genes == 'ENSG00000096384')]/LOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
boxplot(LOE_cis_eQTLs, GOE_cis_eQTLs, names = c('LOE', 'GOE'))
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
boxplot(GOE_tissues/LOE_tissues)
points(GOE_tissues[which(unique_genes == 'ENSG00000096384')]/LOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
GOE_cis_eQTLs/LOE_cis_eQTLs
GOE_cis_eQTLs/LOE_cis_eQTLs == as.numeric(df$GOE_cis_eQTLs)/as.numeric(df$LOE_cis_eQTLs)
as.numeric(df$GOE_cis_eQTLs
)
GOE_cis_eQTLs
as.numeric(as.vector(df$GOE_cis_eQTLs))
GOE_cis_eQTLs/LOE_cis_eQTLs == as.numeric(as.vector(df$GOE_cis_eQTLs))/as.numeric(as.vector(df$LOE_cis_eQTLs))
#saving results
df <- data.frame(cbind(unique_genes, as.numeric(as.vector(LOE_tissues)), as.numeric(as.vector(GOE_tissues)), as.numeric(as.vector(LOE_cis_eQTLs)), as.numeric(as.vector(GOE_cis_eQTLs))) )
df$V2
LOE_tissues
GOE_tissues/LOE_tissues
GOE_tissues/LOE_tissues == GOE_cis_eQTLs/LOE_cis_eQTLs
colnames(df) <- c('gene', 'LOE_tissues', 'GOE_tissues', 'LOE_cis_eQTLs', 'GOE_cis_eQTLs')
View(df)
write.table(df, '../../Body/2_Derived/Gtex.LOE.GOE.tissue.ciseQTL.numbers.per.gene.like.hsp90.txt')
plot(df$LOE_cis_eQTLs, df$GOE_cis_eQTLs, xlab = 'unique LOE cis-eQTLs number', ylab ='unique GOE cis-eQTLs numbe')
View(tissue_num)
View(df)
plot(LOE_cis_eQTLs, GOE_cis_eQTLs, xlab = 'unique LOE cis-eQTLs number', ylab ='unique GOE cis-eQTLs numbe')
plot(LOE_tissues,GOE_tissues, asp = 1, xlab = 'LOE cis-eQTL sum in all tissue', ylab = 'GOE cis-eQTL sum in all tissue')
points(LOE_tissues[which(unique_genes == 'ENSG00000096384')], GOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(40, 36, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE in all tissues')
plot(LOE_cis_eQTLs, GOE_cis_eQTLs, xlab = 'unique LOE cis-eQTLs number', ylab ='unique GOE cis-eQTLs numbe')
points(LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(30, 30, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE cis-eQTL number per gene')
legend(30, 36, legend = 'hsp90', col = 'red', pch=19)
plot(LOE_tissues,GOE_tissues, asp = 1, xlab = 'LOE cis-eQTL sum in all tissue', ylab = 'GOE cis-eQTL sum in all tissue')
points(LOE_tissues[which(unique_genes == 'ENSG00000096384')], GOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(30, 36, legend = 'hsp90', col = 'red', pch=19)
legend(26, 36, legend = 'hsp90', col = 'red', pch=19)
legend(25, 40, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE in all tissues')
plot(LOE_cis_eQTLs, GOE_cis_eQTLs, xlab = 'unique LOE cis-eQTLs number', ylab ='unique GOE cis-eQTLs numbe')
points(LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(25, 30, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE cis-eQTL number per gene')
boxplot(LOE_cis_eQTLs, GOE_cis_eQTLs, names = c('LOE', 'GOE'))
title('cis-eQTL number per gene')
par(mfcol =c(1,1))
boxplot(LOE_cis_eQTLs, GOE_cis_eQTLs, names = c('LOE', 'GOE'))
title('cis-eQTL number per gene')
par(mfcol =c(1,2))
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
boxplot(GOE_tissues/LOE_tissues)
points(GOE_tissues[which(unique_genes == 'ENSG00000096384')]/LOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
dev.off()
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
plot(GOE_cis_eQTLs/LOE_cis_eQTLs)
plot(GOE_tissues/ LOE_tissues)
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE cis-eQTL number')
boxplot(GOE_tissues/LOE_tissues)
points(GOE_tissues[which(unique_genes == 'ENSG00000096384')]/LOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE tissue number')
par(mfcol =c(1,2))
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE cis-eQTL number')
boxplot(GOE_tissues/LOE_tissues)
points(GOE_tissues[which(unique_genes == 'ENSG00000096384')]/LOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE tissue number')
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE cis-eQTL number')
legened(5, 10, legend = 'hsp90', col = 'red', pch = 19)
legened(0, 10, legend = 'hsp90', col = 'red', pch = 19)
legened(1, 10, legend = 'hsp90', col = 'red', pch = 19)
legend(1, 10, legend = 'hsp90', col = 'red', pch = 19)
legend(2, 10, legend = 'hsp90', col = 'red', pch = 19)
legend(1.5, 10, legend = 'hsp90', col = 'red', pch = 19)
legend(1.2, 10, legend = 'hsp90', col = 'red', pch = 19)
legend(1.2, 12, legend = 'hsp90', col = 'red', pch = 19)
legend(1.2, 11, legend = 'hsp90', col = 'red', pch = 19)
boxplot(GOE_tissues/LOE_tissues)
points(GOE_tissues[which(unique_genes == 'ENSG00000096384')]/LOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE tissue number')
legend(1.2, 11, legend = 'hsp90', col = 'red', pch = 19)
legend(1.2, 16, legend = 'hsp90', col = 'red', pch = 19)
#drawing plots
pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.ciseQTL.numbers.genes.like.hsp.pdf')
par(mfcol =c(1,2))
plot(LOE_tissues,GOE_tissues, asp = 1, xlab = 'LOE cis-eQTL sum in all tissue', ylab = 'GOE cis-eQTL sum in all tissue')
points(LOE_tissues[which(unique_genes == 'ENSG00000096384')], GOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(25, 40, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE in all tissues')
plot(LOE_cis_eQTLs, GOE_cis_eQTLs, xlab = 'unique LOE cis-eQTLs number', ylab ='unique GOE cis-eQTLs numbe')
points(LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(25, 30, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE cis-eQTL number per gene')
#pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.numbers.boxplot.hsp.like.genes.pdf')
#in how much tissues there is some particular cis-eQTL in tach gene
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','GOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','GOE_tissues'], names = c('hsp90', 'other genes'))
title('GOE cis-eQTL tissue number')
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','LOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','LOE_tissues'], names = c('hsp90', 'other genes'))
title('LOE cis-eQTL tissue number')
par(mfcol =c(1,1))
boxplot(LOE_cis_eQTLs, GOE_cis_eQTLs, names = c('LOE', 'GOE'))
title('cis-eQTL number per gene')
par(mfcol =c(1,2))
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE cis-eQTL number')
legend(1.2, 11, legend = 'hsp90', col = 'red', pch = 19)
boxplot(GOE_tissues/LOE_tissues)
points(GOE_tissues[which(unique_genes == 'ENSG00000096384')]/LOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE tissue number')
legend(1.2, 16, legend = 'hsp90', col = 'red', pch = 19)
dev.off()
pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.ciseQTL.numbers.genes.like.hsp.pdf')
par(mfcol =c(1,1))
plot(LOE_tissues,GOE_tissues, asp = 1, xlab = 'LOE cis-eQTL sum in all tissue', ylab = 'GOE cis-eQTL sum in all tissue')
points(LOE_tissues[which(unique_genes == 'ENSG00000096384')], GOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(25, 40, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE in all tissues')
plot(LOE_cis_eQTLs, GOE_cis_eQTLs, xlab = 'unique LOE cis-eQTLs number', ylab ='unique GOE cis-eQTLs numbe')
points(LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
legend(25, 30, legend = 'hsp90', col = 'red', pch=19)
title('LOE vs GOE cis-eQTL number per gene')
#pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.numbers.boxplot.hsp.like.genes.pdf')
#in how much tissues there is some particular cis-eQTL in tach gene
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','GOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','GOE_tissues'], names = c('hsp90', 'other genes'))
title('GOE cis-eQTL tissue number')
boxplot(tissue_num[tissue_num$gene == 'ENSG00000096384','LOE_tissues'], tissue_num[tissue_num$gene != 'ENSG00000096384','LOE_tissues'], names = c('hsp90', 'other genes'))
title('LOE cis-eQTL tissue number')
boxplot(LOE_cis_eQTLs, GOE_cis_eQTLs, names = c('LOE', 'GOE'))
title('cis-eQTL number per gene')
boxplot(GOE_cis_eQTLs/LOE_cis_eQTLs)
points(GOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')]/LOE_cis_eQTLs[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE cis-eQTL number')
legend(1.2, 11, legend = 'hsp90', col = 'red', pch = 19)
boxplot(GOE_tissues/LOE_tissues)
points(GOE_tissues[which(unique_genes == 'ENSG00000096384')]/LOE_tissues[which(unique_genes == 'ENSG00000096384')], col = 'red', pch = 19)
title('GOE/LOE tissue number')
legend(1.2, 16, legend = 'hsp90', col = 'red', pch = 19)
dev.off()
