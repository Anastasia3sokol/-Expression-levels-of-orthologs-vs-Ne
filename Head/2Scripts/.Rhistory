rm(list=ls(all=TRUE))
List = list.files("../../Body/1Raw/GTEx_Analysis_v7_eQTL/")
List
rm(list=ls(all=TRUE))
List = list.files("../../Body/1Raw/GTEx_Analysis_v7_eQTL/")
rm(list=ls(all=TRUE))
List = list.files("../../Body/1_Raw/GTEx_Analysis_v7_eQTL/")
List
i = 1
readLines("../../Body/1_Raw/GTEx_Analysis_v7_eQTL/List[i]")
List[i]
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i])
infile
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
infile
QTL = readLines(infile)
QTL = read.table(infile)
QTL = read.table(infile, sep = '\t')
View(QTL)
QTL = read.table(infile, sep = '\t', header = TRUE)
View(QTL)
rm(list=ls(all=TRUE))
List = list.files("../../Body/1_Raw/GTEx_Analysis_v7_eQTL/")
List
(grepl(infile,'v7.signif_variant_gene_pairs.txt.gz')
)
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
(grepl(infile,'v7.signif_variant_gene_pairs.txt.gz'))
rm(list=ls(all=TRUE))
List = list.files("../../Body/1_Raw/GTEx_Analysis_v7_eQTL/")
# v7.egenes.txt.gz; *.egenes.txt.gz files contain data for all genes tested; to obtain the list of eGenes, select the rows with 'qval' ≤ 0.05.
i = 1
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
grepl(infile,'v7.signif_variant_gene_pairs.txt.gz')
i = 2
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
grepl(infile,'v7.signif_variant_gene_pairs.txt.gz')
infile
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
grepl('v7.signif_variant_gene_pairs.txt.gz',infile)
i = 1
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
grepl('v7.signif_variant_gene_pairs.txt.gz',infile)
i = 2
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
grepl('v7.signif_variant_gene_pairs.txt.gz',infile)
rm(list=ls(all=TRUE))
List = list.files("../../Body/1_Raw/GTEx_Analysis_v7_eQTL/")
# v7.egenes.txt.gz; *.egenes.txt.gz files contain data for all genes tested; to obtain the list of eGenes, select the rows with 'qval' ≤ 0.05.
# v7.signif_variant_gene_pairs.txt.gz; all significant variant-gene associations based on permutations
for (i in 1:length(List))
{ # i = 2
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
if (grepl('v7.signif_variant_gene_pairs.txt.gz',infile))
{
QTL = read.table(infile, sep = '\t', header = TRUE)
}
}
View(QTL)
QTL = QTL[QTL$gene_id == 'ENSG00000096384',]
i = 2
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
if (grepl('v7.signif_variant_gene_pairs.txt.gz',infile))
QTL = read.table(infile, sep = '\t', header = TRUE)
QTL = QTL[QTL$gene_id == 'ENSG00000096384',]
}
QTL = read.table(infile, sep = '\t', header = TRUE)
View(QTL)
QTL$gene_id = gsub("\\.(.*)",'',QTL$gene_id)
View(QTL)
QTL = QTL[QTL$gene_id == 'ENSG00000096384',]
View(QTL)
tissue = ('v7.signif_variant_gene_pairs.txt.gz','',List[i])
List[i]
tissue = gsub('v7.signif_variant_gene_pairs.txt.gz','',List[i])
tissue
tissue = gsub('.v7.signif_variant_gene_pairs.txt.gz','',List[i])
tissue
QTL$Tissue = tissue
rm(list=ls(all=TRUE))
List = list.files("../../Body/1_Raw/GTEx_Analysis_v7_eQTL/")
# v7.egenes.txt.gz; *.egenes.txt.gz files contain data for all genes tested; to obtain the list of eGenes, select the rows with 'qval' ≤ 0.05.
# v7.signif_variant_gene_pairs.txt.gz; all significant variant-gene associations based on permutations
Final = c()
for (i in 1:length(List))
{ # i = 2
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
if (grepl('v7.signif_variant_gene_pairs.txt.gz',infile))
{
tissue = gsub('.v7.signif_variant_gene_pairs.txt.gz','',List[i])
QTL = read.table(infile, sep = '\t', header = TRUE)
QTL$gene_id = gsub("\\.(.*)",'',QTL$gene_id)
QTL = QTL[QTL$gene_id == 'ENSG00000096384',]
QTL$Tissue = tissue
Final = rbind(Final,QTL)
}
}
i
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
infile
tissue = gsub('.v7.signif_variant_gene_pairs.txt.gz','',List[i])
tissue
QTL = read.table(infile, sep = '\t', header = TRUE)
QTL$gene_id = gsub("\\.(.*)",'',QTL$gene_id)
QTL = QTL[QTL$gene_id == 'ENSG00000096384',]
rm(list=ls(all=TRUE))
List = list.files("../../Body/1_Raw/GTEx_Analysis_v7_eQTL/")
# v7.egenes.txt.gz; *.egenes.txt.gz files contain data for all genes tested; to obtain the list of eGenes, select the rows with 'qval' ≤ 0.05.
# v7.signif_variant_gene_pairs.txt.gz; all significant variant-gene associations based on permutations
AllSignifVarGenePairs = c()
for (i in 1:length(List))
{ # i = 2
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
if (grepl('v7.signif_variant_gene_pairs.txt.gz',infile))
{
tissue = gsub('.v7.signif_variant_gene_pairs.txt.gz','',List[i])
QTL = read.table(infile, sep = '\t', header = TRUE)
QTL$gene_id = gsub("\\.(.*)",'',QTL$gene_id)
QTL = QTL[QTL$gene_id == 'ENSG00000096384',]
if (nrow(QTL) > 0) {QTL$Tissue = tissue; AllSignifVarGenePairs = rbind(AllSignifVarGenePairs,QTL)}
}
}
View(AllSignifVarGenePairs)
plot(AllSignifVarGenePairs$slope,AllSignifVarGenePairs$maf)
rm(list=ls(all=TRUE))
List = list.files("../../Body/1_Raw/GTEx_Analysis_v7_eQTL/")
# v7.egenes.txt.gz; *.egenes.txt.gz files contain data for all genes tested; to obtain the list of eGenes, select the rows with 'qval' ≤ 0.05.
# v7.signif_variant_gene_pairs.txt.gz; all significant variant-gene associations based on permutations
AllSignifVarGenePairs = c()
TheBestVarPerGene = c()
for (i in 1:length(List))
{ # i = 2
infile = paste('../../Body/1_Raw/GTEx_Analysis_v7_eQTL/',List[i], sep = '')
if (grepl('v7.signif_variant_gene_pairs.txt.gz',infile))
{
tissue = gsub('.v7.signif_variant_gene_pairs.txt.gz','',List[i])
QTL = read.table(infile, sep = '\t', header = TRUE)
QTL$gene_id = gsub("\\.(.*)",'',QTL$gene_id)
QTL = QTL[QTL$gene_id == 'ENSG00000096384',]
if (nrow(QTL) > 0) {QTL$Tissue = tissue; AllSignifVarGenePairs = rbind(AllSignifVarGenePairs,QTL)}
}
if (grepl('v7.egenes.txt.gz',infile))
{
tissue = gsub('.v7.egenes.txt.gz','',List[i])
QTL = read.table(infile, sep = '\t', header = TRUE)
QTL$gene_id = gsub("\\.(.*)",'',QTL$gene_id)
QTL = QTL[QTL$gene_id == 'ENSG00000096384',]
if (nrow(QTL) > 0) {QTL$Tissue = tissue; TheBestVarPerGene = rbind(TheBestVarPerGene,QTL)}
}
}
plot(AllSignifVarGenePairs$slope,AllSignifVarGenePairs$maf)
View(TheBestVarPerGene)
write.table(TheBestVarPerGene,file = "../../Body/2_Derived/Gtex.Hsp90.TheBestVarPerGene.txt")
write.table(AllSignifVarGenePairs,file = "../../Body/2_Derived/Gtex.Hsp90.AllSignifVarGenePairs.txt")
plot(AllSignifVarGenePairs$slope,AllSignifVarGenePairs$maf)
View(TheBestVarPerGene)
plot(TheBestVarPerGene$slope,TheBestVarPerGene$maf) # minor allele effect versus minor allele frequency
plot(TheBestVarPerGene$slope*TheBestVarPerGene$ref_factor,TheBestVarPerGene$maf) # minor allele effect versus minor allele frequency
