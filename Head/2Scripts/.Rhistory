setwd('/Users/redmi/Desktop/HSP/HSP/Head/2Scripts/')
rm(list=ls(all=TRUE))
All_best_var <- read.table('../../Body/2_Derived/All.best.vat.all.tissue.variants.outside.genes.important.columns.txt')
All_best_var[,'genes'] <- gsub('[0-9, A-Z]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
All_best_var['hsp90'] <- All_best_var$genes == 'ENSG00000096384'
All_best_var['GOE'] <- All_best_var$slope > 0
genes <- read.table('../../Body/1_Raw/gencode.v25.annotation.gtf.Genes.Shet.pLI.FIS.RVIS.GHIS.KnKs.GC.BrainSpecificRanking.Branch', header = 1)
cds <-  as.vector(genes[genes$GeneType == 'protein_coding', 'EnsemblId'])
genes.like.hsp <- as.vector(read.table('../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')[1:300,1])
All_best_var_genes_like_hsp <- All_best_var[All_best_var$genes %in% genes.like.hsp,] #choose hsp-like genes only
library(stringr)
All_best_var_protein_coding <- All_best_var[cds %in% All_best_var$genes]
View(All_best_var)
All_best_var_protein_coding <- All_best_var[cds %in% All_best_var$genes]
All_best_var_protein_coding <- All_best_var[All_best_var$genes %in% cds]
All_best_var$genes %in% cds
All_best_var_protein_coding <- All_best_var[cds %in% All_best_var$genes,]
rm(list = ls(all = T))
tissue_num <- read.table('../../Body/2_Derived/Gtex.LOE.GOE.tissues.numbers.frec.more.5.perc.txt')
gene <- gsub('.*b37_','', tissue_num$cis_eQTL_id)
tissue_num <- cbind(tissue_num, gene)
LOE_tissues <- c()
LOE_cis_eQTLs <- c()
GOE_tissues <- c()
GOE_cis_eQTLs <- c()
unique_genes <- unique(gene)
for (g in unique_genes){
#count common amount of tissues for each gene in which there is cis-eQTLs
loe_tis <- sum(tissue_num[tissue_num$gene == g,'LOE_tissues'])
goe_tis <- sum(tissue_num[tissue_num$gene == g,'GOE_tissues'])
LOE_tissues <- c(LOE_tissues,loe_tis)
GOE_tissues <- c(GOE_tissues,goe_tis)
#count common amount of unique cis-eQTLs for each gene
loe_eqtl <- dim(tissue_num[(tissue_num$gene == g) & (tissue_num$LOE_tissues > 0),])[1]
goe_eqtl <- dim(tissue_num[(tissue_num$gene == g) & (tissue_num$GOE_tissues > 0),])[1]
LOE_cis_eQTLs <- c(LOE_cis_eQTLs, loe_eqtl)
GOE_cis_eQTLs <- c(GOE_cis_eQTLs, goe_eqtl)
}
#saving results
df <- data.frame(cbind(unique_genes, as.numeric(as.vector(LOE_tissues)), as.numeric(as.vector(GOE_tissues)), as.numeric(as.vector(LOE_cis_eQTLs)), as.numeric(as.vector(GOE_cis_eQTLs))) )
colnames(df) <- c('gene', 'LOE_tissues', 'GOE_tissues', 'LOE_cis_eQTLs', 'GOE_cis_eQTLs')
View(tissue_num)
rm(list=ls(all=TRUE))
All_best_var <- read.table('../../Body/2_Derived/All.best.vat.all.tissue.variants.outside.genes.important.columns.txt')
All_best_var[,'genes'] <- gsub('[0-9, A-Z]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
All_best_var['hsp90'] <- All_best_var$genes == 'ENSG00000096384'
All_best_var['GOE'] <- All_best_var$slope > 0
genes <- read.table('../../Body/1_Raw/gencode.v25.annotation.gtf.Genes.Shet.pLI.FIS.RVIS.GHIS.KnKs.GC.BrainSpecificRanking.Branch', header = 1)
cds <-  as.vector(genes[genes$GeneType == 'protein_coding', 'EnsemblId'])
genes.like.hsp <- as.vector(read.table('../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')[1:300,1])
All_best_var_genes_like_hsp <- All_best_var[All_best_var$genes %in% genes.like.hsp,] #choose hsp-like genes only
View(All_best_var)
genes <- gsub('.*b37_','', All_best_var$cis_eQTL_id)
genes
length(genes)
length(unique(genes))
c = c + All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"])
c = 0
for (tissue in unique(All_best_var$Tissue)) {
c = c + All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"])
}
c = c + (All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"]))
c
length(c)
sum(c)
length(c) == sum(c)
c = с()
st = с()
c = 0
for (tissue in unique(All_best_var$Tissue)) {
c = c + (All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"]))
}
0
c = 0
for (tissue in unique(All_best_var$Tissue)) {
c = c + (All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"]))
}
(All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"]))
All_best_var <- read.table('../../Body/2_Derived/All.best.vat.all.tissue.variants.outside.genes.important.columns.txt')
rm(list=ls(all=TRUE))
All_best_var <- read.table('../../Body/2_Derived/All.best.vat.all.tissue.variants.outside.genes.important.columns.txt')
All_best_var[,'genes'] <- gsub('[0-9, A-Z]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
All_best_var['hsp90'] <- All_best_var$genes == 'ENSG00000096384'
All_best_var['GOE'] <- All_best_var$slope > 0
c = 0
All_best_var[,'genes'] <- gsub('[0-9, A-Z]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
All_best_var['hsp90'] <- All_best_var$genes == 'ENSG00000096384'
All_best_var['GOE'] <- All_best_var$slope > 0
c = 0
for (tissue in unique(All_best_var$Tissue)) {
c = c + (All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"]))
}
All_best_var[,'genes'] <- gsub('[0-9, A-Z]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
All_best_var['hsp90'] <- All_best_var$genes == 'ENSG00000096384'
All_best_var['GOE'] <- All_best_var$slope > 0
c1 = 0
for (tissue in unique(All_best_var$Tissue)) {
c1 = c(c1, (All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"])))
}
c
for (tissue in unique(All_best_var$Tissue)) {
print(All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"]))
}
for (tissue in unique(All_best_var$Tissue)) {
print(all.equal(All_best_var[All_best_var$Tissue == tissue, "genes"] == unique(All_best_var[All_best_var$Tissue == tissue, "genes"])))
}
for (tissue in unique(All_best_var$Tissue)) {
print(all.equal(All_best_var[All_best_var$Tissue == tissue, "genes"], unique(All_best_var[All_best_var$Tissue == tissue, "genes"])))
}
c1 = 0
for (tissue in unique(All_best_var$Tissue)) {
c1 += (all.equal(All_best_var[All_best_var$Tissue == tissue, "genes"], unique(All_best_var[All_best_var$Tissue == tissue, "genes"])))
}
for (tissue in unique(All_best_var$Tissue)) {
c1 += (all.equal(All_best_var[All_best_var$Tissue == tissue, "genes"], unique(All_best_var[All_best_var$Tissue == tissue, "genes"])))
}
c1 = c1 +  (all.equal(All_best_var[All_best_var$Tissue == tissue, "genes"], unique(All_best_var[All_best_var$Tissue == tissue, "genes"])))
c1 = 0
for (tissue in unique(All_best_var$Tissue)) {
c1 = c1 +  (all.equal(All_best_var[All_best_var$Tissue == tissue, "genes"], unique(All_best_var[All_best_var$Tissue == tissue, "genes"])))
}
c1 == length(unique(All_best_var$Tissue)) #TRUE
