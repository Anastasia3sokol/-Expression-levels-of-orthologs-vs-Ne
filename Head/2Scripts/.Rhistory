points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], col = 'red', pch = 19)
legend('topright', legend = 'HSP90AB1', col = 'red', pch = 19)
title('rank Spearman correlation for genes like HSP90AB1, n = 84')
dev.off()
df_hsp90_sp <- df[df$Species %in% hsp90$Species,] #to make model for other genes using more or less same speciaes as hsp90
cols <- colnames(df_hsp90_sp[,-c(1, 302)])
for (c in cols) {
if (length(df_hsp90_sp[is.na(df_hsp90_sp[,c]),c]) >= 10){
df_hsp90_sp[,c] <- NULL
}
}
rows <- rownames(df_hsp90_sp)
for (r in rows) {
if (length(df_hsp90_sp[r, is.na(df_hsp90_sp[r,])]) >= 10){
df_hsp90_sp <- df_hsp90_sp[-as.numeric(r),]
}
}
rho <- c()
S <- c()
p_val <- c()
number_of_species <- c()
genes <- colnames(df_hsp90_sp)[-c(1,86)]
rho <- c()
S <- c()
p_val <- c()
number_of_species <- c()
genes <- colnames(df_hsp90_sp)[-c(1,179)]
for (gene in genes){
a <- na.omit(df_hsp90_sp[,c("Species", gene, 'Generation_Length')])
species <- a[,'Species']
number_of_species <- c(number_of_species, length(species))
rcor <- cor.test(~ a[,gene] + a[,'Generation_Length'], method = 'spearman', continuity = F, conf.level = 0.95)
rho <- c(rho, rcor$estimate)
S <- c(S, rcor$statistic)
p_val <- c(p_val, rcor$p.value)
}
results <- data.frame(genes, S, rho, p_val, number_of_species)
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], results[results$genes == 'dN.dS_ENSG00000096384', 'p_val'], col = 'red', pch = 19)
plot(~results$rho + results$p_val)
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], results[results$genes == 'dN.dS_ENSG00000096384', 'p_val'], col = 'red', pch = 19)
boxplot(results$rho, ylab = 'Spearman\'s rho')
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], col = 'red', pch = 19)
pdf('../../Body/4_Figures/hsp.like.genes.spearman.rank.cor.less.10.sp.pdf')
plot(~results$rho + results$p_val)
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], results[results$genes == 'dN.dS_ENSG00000096384', 'p_val'], col = 'red', pch = 19)
legend('topright', legend = 'HSP90AB1', col = 'red', pch = 19)
title('rank Spearman correlation for genes like HSP90AB1, n = 177')
boxplot(results$rho, ylab = 'Spearman\'s rho')
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], col = 'red', pch = 19)
legend('topright', legend = 'HSP90AB1', col = 'red', pch = 19)
title('rank Spearman correlation for genes like HSP90AB1, n = 177')
dev.off()
df_hsp90_sp <- df[df$Species %in% hsp90$Species,] #to make model for other genes using more or less same speciaes as hsp90
cols <- colnames(df_hsp90_sp[,-c(1, 302)])
for (c in cols) {
if (length(df_hsp90_sp[is.na(df_hsp90_sp[,c]),c]) >= 15){
df_hsp90_sp[,c] <- NULL
}
}
rows <- rownames(df_hsp90_sp)
for (r in rows) {
if (length(df_hsp90_sp[r, is.na(df_hsp90_sp[r,])]) >= 15){
df_hsp90_sp <- df_hsp90_sp[-as.numeric(r),]
}
}
rho <- c()
S <- c()
p_val <- c()
number_of_species <- c()
genes <- colnames(df_hsp90_sp)[-c(1,217)]
for (gene in genes){
a <- na.omit(df_hsp90_sp[,c("Species", gene, 'Generation_Length')])
species <- a[,'Species']
number_of_species <- c(number_of_species, length(species))
rcor <- cor.test(~ a[,gene] + a[,'Generation_Length'], method = 'spearman', continuity = F, conf.level = 0.95)
rho <- c(rho, rcor$estimate)
S <- c(S, rcor$statistic)
p_val <- c(p_val, rcor$p.value)
}
results <- data.frame(genes, S, rho, p_val, number_of_species)
plot(~results$rho + results$p_val)
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], results[results$genes == 'dN.dS_ENSG00000096384', 'p_val'], col = 'red', pch = 19)
legend('topright', legend = 'HSP90AB1', col = 'red', pch = 19)
title('rank Spearman correlation for genes like HSP90AB1, n = 177')
boxplot(results$rho, ylab = 'Spearman\'s rho')
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], col = 'red', pch = 19)
pdf('../../Body/4_Figures/hsp.like.genes.spearman.rank.cor.less.15.sp.pdf')
plot(~results$rho + results$p_val)
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], results[results$genes == 'dN.dS_ENSG00000096384', 'p_val'], col = 'red', pch = 19)
legend('topright', legend = 'HSP90AB1', col = 'red', pch = 19)
title('rank Spearman correlation for genes like HSP90AB1, n = 215')
boxplot(results$rho, ylab = 'Spearman\'s rho')
points(results[results$genes=='dN.dS_ENSG00000096384', 'rho'], col = 'red', pch = 19)
legend('topright', legend = 'HSP90AB1', col = 'red', pch = 19)
title('rank Spearman correlation for genes like HSP90AB1, n = 215')
dev.off()
rm(list = ls(all = T))
tissue_num <- read.table('../../Body/2_Derived/Gtex.LOE.GOE.tissues.numbers.frec.more.5.perc.txt')
View(tissue_num)
rm(list=ls(all=TRUE))
All_best_var <- read.table('../../Body/2_Derived/All.best.vat.all.tissue.variants.outside.genes.important.columns.txt')
View(All_best_var)
grep('ENSG+', All_best_var$cis_eQTL_id)
grepl('ENSG+', All_best_var$cis_eQTL_id)
grep('ENSG+', All_best_var$cis_eQTL_id, value = T)
grepl('ENSG+', All_best_var$cis_eQTL_id, value = T)
gsub('[0-9]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
All_best_var[,'genes'] <- gsub('[0-9]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
View(All_best_var)
gsub('[0-9, A-Z]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
All_best_var[,'genes'] <- gsub('[0-9, A-Z]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
View(All_best_var)
boxplot(All_best_var$Assessed_Allele_Freq)
points(All_best_var[All_best_var$genes == 'ENSG00000096384', 'Assessed_Allele_Freq'], col = 'red', pch =19)
All_best_var[All_best_var$genes == 'ENSG00000096384', 'Assessed_Allele_Freq']
legend('toprigth', legend = 'HSP90AB1', col = 'red', pch = 19)
legend('topright', legend = 'HSP90AB1', col = 'red', pch = 19)
title('Assesed Allele Frequency')
#for all genes
boxplot(All_best_var$Assessed_Allele_Freq)
points(All_best_var[All_best_var$genes == 'ENSG00000096384', 'Assessed_Allele_Freq'], col = 'red', pch =19)
points(All_best_var[All_best_var$genes == 'ENSG00000096384', 'Assessed_Allele_Freq'])
All_best_var[All_best_var$genes == 'ENSG00000096384',]
All_best_var$genes == 'ENSG00000096384'
All_best_var['hsp90'] <- All_best_var$genes == 'ENSG00000096384'
#for all genes
boxplot(All_best_var$Assessed_Allele_Freq ~ All_best_var$hsp90)
legend('topright', legend = 'HSP90AB1', col = 'red', pch = 19)
#for all genes
boxplot(All_best_var$Assessed_Allele_Freq ~ All_best_var$hsp90, names = c('all genes', 'HSP90AB1'))
title('Assesed Allele Frequency')
All_best_var['GOE_or_LOE'] <- All_best_var$slope > 0
abs(-3)
boxplot(abs(slope) ~ hsp90 * GOE_or_LOE, data = All_best_var)
boxplot(abs(All_best_var$slope))
boxplot(abs(All_best_var[All_best_var$slope < 100, 'slope']))
boxplot(abs(All_best_var[All_best_var$slope < 50, 'slope']))
boxplot(abs(All_best_var[All_best_var$slope < 50 | All_best_var$slope > -50, 'slope']))
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']))
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) * All_best_var$hsp90)
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) * All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, hsp90])
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) * All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'])
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) ~ All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'])
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'],
names = c('all genes', 'HSP90AB1'))
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes', 'HSP90AB1'))
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'])
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs')
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'Assessed_Allele_Freq']) ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Assesed Allele Frequency of cis-eQTLs')
boxplot(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'Assessed_Allele_Freq'] ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Assesed Allele Frequency of cis-eQTLs')
genes.like.hsp <- as.vector(read.table('../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')[1:300,1])
All_best_var_genes_like_hsp <- All_best_var[grepl(paste(genes.like.hsp, collapse="|"), All_best_var$cis_eQTL_id),] #choose hsp-like genes only
boxplot(All_best_var_genes_like_hsp$Assessed_Allele_Freq ~ All_best_var_genes_like_hsp$hsp90, names = c('all genes', 'HSP90AB1'))
title('Assesed Allele Frequency')
boxplot(abs(All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$slope < 50 & All_best_var_genes_like_hsp$slope > -50, 'slope']) ~
All_best_var[All_best_var_genes_like_hsp$slope < 50 & All_best_var_genes_like_hsp$slope > -50, 'hsp90'] *
All_best_var[All_best_var_genes_like_hsp$slope < 50 & All_best_var_genes_like_hsp$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs')
boxplot(abs(All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$slope < 50 & All_best_var_genes_like_hsp$slope > -50, 'slope']) ~
All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$slope < 50 & All_best_var_genes_like_hsp$slope > -50, 'hsp90'] *
All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$slope < 50 & All_best_var_genes_like_hsp$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs')
boxplot(abs(All_best_var_genes_like_hsp[, 'slope']))
boxplot(abs(All_best_var_genes_like_hsp[, 'slope'])) ~
All_best_var_genes_like_hsp[, 'hsp90'] *
All_best_var_genes_like_hsp[, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs')
boxplot(abs(All_best_var_genes_like_hsp[, 'slope']) ~
All_best_var_genes_like_hsp[, 'hsp90'] *
All_best_var_genes_like_hsp[, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs')
pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.numbers.slopes.assessed.allele.freq.pdf')
#for all genes
boxplot(All_best_var$Assessed_Allele_Freq ~ All_best_var$hsp90, names = c('all genes', 'HSP90AB1'))
title('Assesed Allele Frequency')
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs')
boxplot(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'Assessed_Allele_Freq'] ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Assesed Allele Frequency of cis-eQTLs')
genes.like.hsp <- as.vector(read.table('../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')[1:300,1])
All_best_var_genes_like_hsp <- All_best_var[grepl(paste(genes.like.hsp, collapse="|"), All_best_var$cis_eQTL_id),] #choose hsp-like genes only
boxplot(All_best_var_genes_like_hsp$Assessed_Allele_Freq ~ All_best_var_genes_like_hsp$hsp90, names = c('hsp90 like genes', 'HSP90AB1'))
title('Assesed Allele Frequency in genes like hsp90')
boxplot(abs(All_best_var_genes_like_hsp[, 'slope']) ~
All_best_var_genes_like_hsp[, 'hsp90'] *
All_best_var_genes_like_hsp[, 'GOE_or_LOE'],
names = c('hsp90 like genes LOE', 'HSP90AB1 LOE', 'hsp90 like genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs in genes like hsp90')
boxplot(All_best_var_genes_like_hsp[, 'Assessed_Allele_Freq'] ~
All_best_var_genes_like_hsp[, 'hsp90'] *
All_best_var_genes_like_hsp[, 'GOE_or_LOE'],
names = c('hsp90 like genes LOE', 'HSP90AB1 LOE', 'hsp90 like genes GOE', 'HSP90AB1 GOE'),
main = 'Assesed Allele Frequency of cis-eQTLs in genes like hsp90')
dev.off()
hsp_LOE <- All_best_var_hsp[All_best_var_hsp$slope < 0, 'Assessed_Allele_Freq']
#look at hsp90
All_best_var_hsp <- All_best_var_genes_like_hsp[grepl('ENSG00000096384', All_best_var_genes_like_hsp$cis_eQTL_id),]
length(All_best_var_hsp$cis_eQTL_id) == length(unique(All_best_var_hsp$cis_eQTL_id)) #TRUE 47
hsp_LOE <- All_best_var_hsp[All_best_var_hsp$slope < 0, 'Assessed_Allele_Freq']
hsp_GOE <- All_best_var_hsp[All_best_var_hsp$slope > 0, 'Assessed_Allele_Freq']
x <- c(hsp_GOE, hsp_LOE)
gp = c(rep("hsp90 GOE Assessed allele freq", length(hsp_GOE)),rep("hsp90 LOE Assessed allele freq",length(hsp_LOE)))
boxplot(x ~ gp, xlab = '', ylab = 'Assesed allele frequency')
LOE <- All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$slope < 0, 'Assessed_Allele_Freq']
GOE <- All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$slope > 0, 'Assessed_Allele_Freq']
boxplot(LOE, GOE, names=c('LOE', 'GOE'), ylab = 'Assesed allele frequency')
LOE <- All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$slope < 0, 'Assessed_Allele_Freq']
boxplot(x ~ gp, xlab = '', ylab = 'Assesed allele frequency')
pdf('../../Body/4_Figures/Gtex.LOE.GOE.tissue.numbers.slopes.assessed.allele.freq.pdf')
#for all genes
boxplot(All_best_var$Assessed_Allele_Freq ~ All_best_var$hsp90, names = c('all genes', 'HSP90AB1'))
title('Assesed Allele Frequency')
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs')
boxplot(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'Assessed_Allele_Freq'] ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Assesed Allele Frequency of cis-eQTLs')
boxplot(All_best_var_genes_like_hsp$Assessed_Allele_Freq ~ All_best_var_genes_like_hsp$hsp90, names = c('hsp90 like genes', 'HSP90AB1'))
title('Assesed Allele Frequency in genes like hsp90')
boxplot(abs(All_best_var_genes_like_hsp[, 'slope']) ~
All_best_var_genes_like_hsp[, 'hsp90'] *
All_best_var_genes_like_hsp[, 'GOE_or_LOE'],
names = c('hsp90 like genes LOE', 'HSP90AB1 LOE', 'hsp90 like genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs in genes like hsp90')
boxplot(All_best_var_genes_like_hsp[, 'Assessed_Allele_Freq'] ~
All_best_var_genes_like_hsp[, 'hsp90'] *
All_best_var_genes_like_hsp[, 'GOE_or_LOE'],
names = c('hsp90 like genes LOE', 'HSP90AB1 LOE', 'hsp90 like genes GOE', 'HSP90AB1 GOE'),
main = 'Assesed Allele Frequency of cis-eQTLs in genes like hsp90')
boxplot(x ~ gp, xlab = '', ylab = 'Assesed allele frequency', mail = 'Assessed Allele Frequency HSP90AB1')
boxplot(LOE, GOE, names=c('LOE', 'GOE'), ylab = 'Assesed allele frequency')
title('cis-eQTL assesed allele frequency')
dev.off()
rm(list=ls(all=TRUE))
df <- read.table('../../Body/2_Derived/kn.ks.all.hsp.txt')
df[df == 'n/a'] <- NA
df[, -1] <- sapply(df[, -1], as.vector)
df[, -1] <- sapply(df[, -1], as.numeric)
#delete columns with too much NA
todrop <- c()
for (col in colnames(df[,-c(1,96)])) {
if (sum(is.na(df[,col])) > 35) {
todrop <- c(todrop, col)
}
}
df <- df[, !(names(df) %in% todrop)]
#saving linear regression parameters
slopes <- c()
p_val_slope <- c()
intercept <- c()
p_val_intercept <- c()
R_sq <- c()
R_sq_adj <- c()
residual_std_err <- c()
number_of_species <- c()
genes <- colnames(df)[-c(1,75)]
for (gene in genes) {
#a <- na.omit(df[,c(gene, 'Generation_Length')])
if ((length(df[,gene]) - sum(is.na(df[,gene]))) < 10){
print(gene)
genes <- genes[genes != gene]
next
}
a <- na.omit(df[,c("Species", gene, 'Generation_Length')])
species <- a[,'Species']
number_of_species <- c(number_of_species, length(species))
y <- log10(((a[,gene] - mean(a[,gene]))/sd(a[,gene]))+5)
x <- log10(((a[,'Generation_Length'] - mean(a[,'Generation_Length']))/sd(a[,'Generation_Length']))+5)
lg <- lm(y~x, data = a)
sum <- summary(lg)
b <- sum$coefficients
slopes <- c(slopes, b[2,1])
p_val_slope <- c(p_val_slope, b[2,4])
intercept <- c(intercept, b[1,1])
p_val_intercept <- c(p_val_intercept, b[1,4])
R_sq <- c(R_sq, sum$r.squared)
R_sq_adj <- c(R_sq_adj, sum$adj.r.squared)
residual_std_err <- c(residual_std_err, sum$sigma)
}
#table with linear regression parameters
results <- data.frame(genes, slopes, intercept, p_val_slope, p_val_intercept, number_of_species, R_sq, R_sq_adj, residual_std_err)
write.table(results, '../../Body/3_Results/linear.regression..normalized.kn.ks.vs.generation.length.all.hsp.mammals.txt'            )
write.table(results, '../../Body/3_Results/linear.regression.normalized.kn.ks.vs.generation.length.all.hsp.mammals.txt'            )
hsps  <- read.table('../../Body/2_Derived/human.hsp.ensID.group.txt', header = T, sep = '\t')
hsps$Ensembl.gene.ID <- paste('dN.dS_', hsps$Ensembl.gene.ID, sep = '')
results <- merge(x = results, y = hsps, by.x = 'genes', by.y = 'Ensembl.gene.ID')
library(ggplot2)
theme_set(theme_bw())
gg <- ggplot(results, aes(intercept, slopes))+
geom_point(aes(col = Group.name))+
xlab('intercept')+
ylab('slope')+
labs(title ='Slope vs intercept all hsp genes', subtitle = 'n=73')
print(gg)
pdf('../../Body/4_Figures/all.hsp.linear.model.slopes.normalized.pdf')
print(gg)
boxplot(results[,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=73')
legend(x=1.3, y = 0.00015,legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=73')
legend(x = 1.3, y = 0.37, legend = 'hsp90', col = 'red', pch = 19)
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept all hsp genes\n n=73')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=59, p_value_slope < 0.05')
legend(x = 1.3, y = 0.00015,legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=59, p_value_slope < 0.05')
legend(x = 1.3, y = 0.37, legend = 'hsp90', col = 'red', pch = 19)
plot(results[results$p_val_slope < 0.05,'intercept'], results[results$p_val_slope < 0.05,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept for all hsp genes\n n=59, p_value_slope < 0.05')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
dev.off()
gg <- ggplot(results, aes(intercept, slopes))+
geom_point(aes(col = Group.name), alpha = 0.2)+
xlab('intercept')+
ylab('slope')+
labs(title ='Slope vs intercept all hsp genes', subtitle = 'n=73')
print(gg)
gg <- ggplot(results, aes(intercept, slopes))+
geom_point(aes(col = Group.name), alpha = 0.2, size =2)+
xlab('intercept')+
ylab('slope')+
labs(title ='Slope vs intercept all hsp genes', subtitle = 'n=73')
print(gg)
gg <- ggplot(results, aes(intercept, slopes))+
geom_point(aes(col = Group.name), alpha = 0.2, size =5)+
xlab('intercept')+
ylab('slope')+
labs(title ='Slope vs intercept all hsp genes', subtitle = 'n=73')
print(gg)
gg <- ggplot(results, aes(intercept, slopes))+
geom_point(aes(col = Group.name), alpha = 0.2, size =3)+
xlab('intercept')+
ylab('slope')+
labs(title ='Slope vs intercept all hsp genes', subtitle = 'n=73')
print(gg)
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
print(gg)
gg <- ggplot(results, aes(intercept, slopes))+
geom_point(aes(col = Group.name), alpha = 0.5, size =3)+
xlab('intercept')+
ylab('slope')+
labs(title ='Slope vs intercept all hsp genes', subtitle = 'n=73')
print(gg)
pdf('../../Body/4_Figures/all.hsp.linear.model.slopes.normalized.pdf')
print(gg)
boxplot(results[,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=73')
legend(x=1.3, y = 0.00015,legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=73')
legend(x = 1.3, y = 0.37, legend = 'hsp90', col = 'red', pch = 19)
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept all hsp genes\n n=73')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=59, p_value_slope < 0.05')
legend(x = 1.3, y = 0.00015,legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=59, p_value_slope < 0.05')
legend(x = 1.3, y = 0.37, legend = 'hsp90', col = 'red', pch = 19)
plot(results[results$p_val_slope < 0.05,'intercept'], results[results$p_val_slope < 0.05,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept for all hsp genes\n n=59, p_value_slope < 0.05')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
dev.off()
results[results$p_val_slope < 0.05,'slopes']
length(results[results$p_val_slope < 0.05,'slopes'])
pdf('../../Body/4_Figures/all.hsp.linear.model.slopes.normalized.pdf')
print(gg)
boxplot(results[,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=73')
legend(x=1.3, y = 0.00015,legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=73')
legend(x = 1.3, y = 0.37, legend = 'hsp90', col = 'red', pch = 19)
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept all hsp genes\n n=73')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=60, p_value_slope < 0.05')
legend(x = 1.3, y = 0.00015,legend = 'hsp90', col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for all hsp genes\n n=60, p_value_slope < 0.05')
legend(x = 1.3, y = 0.37, legend = 'hsp90', col = 'red', pch = 19)
plot(results[results$p_val_slope < 0.05,'intercept'], results[results$p_val_slope < 0.05,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
title('Slope vs intercept for all hsp genes\n n=60, p_value_slope < 0.05')
legend(x = 0.35, y = 0.00015, legend = 'hsp90', col = 'red', pch = 19)
dev.off()
plot(results[results$p_val_slope < 0.05,'intercept'], results[results$p_val_slope < 0.05,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
results <- read.table('../../Body/3_Results/all.hsp.spearman.rank.cor.txt')
plot(~results$rho + results$p_val, col = results$group, pch = 19)
boxplot(rho~group, data=results, ylab ='Spearman rho')
stripchart(rho~group, data=results,vertical=TRUE, add=TRUE, method="stack", pch =1)
title('rank Spearman correlation for all hsps')
boxplot(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'Assessed_Allele_Freq'] ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Assesed Allele Frequency of cis-eQTLs')
genes.like.hsp <- as.vector(read.table('../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')[1:300,1])
All_best_var <- read.table('../../Body/2_Derived/All.best.vat.all.tissue.variants.outside.genes.important.columns.txt')
All_best_var[,'genes'] <- gsub('[0-9, A-Z]+_[0-9]+_[A-Z]+_[A-Z]+_b37_', '', All_best_var$cis_eQTL_id)
All_best_var['hsp90'] <- All_best_var$genes == 'ENSG00000096384'
All_best_var['GOE_or_LOE'] <- All_best_var$slope > 0
#for all genes
boxplot(All_best_var$Assessed_Allele_Freq ~ All_best_var$hsp90, names = c('all genes', 'HSP90AB1'))
#for all genes
boxplot(All_best_var$Assessed_Allele_Freq ~ All_best_var$hsp90, names = c('all genes', 'HSP90AB1'))
boxplot(abs(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'slope']) ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Slopes of cis-eQTLs')
boxplot(All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'Assessed_Allele_Freq'] ~
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'hsp90'] *
All_best_var[All_best_var$slope < 50 & All_best_var$slope > -50, 'GOE_or_LOE'],
names = c('all genes LOE', 'HSP90AB1 LOE', 'all genes GOE', 'HSP90AB1 GOE'),
main = 'Assesed Allele Frequency of cis-eQTLs')
#look at hsp90
All_best_var_hsp <- All_best_var_genes_like_hsp[grepl('ENSG00000096384', All_best_var_genes_like_hsp$cis_eQTL_id),]
All_best_var_genes_like_hsp_freq <- (All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$Assessed_Allele_Freq >= 0.05,])
genes.like.hsp <- as.vector(read.table('../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')[1:300,1])
All_best_var_genes_like_hsp <- All_best_var[grepl(paste(genes.like.hsp, collapse="|"), All_best_var$cis_eQTL_id),] #choose hsp-like genes only
All_best_var_genes_like_hsp_freq <- (All_best_var_genes_like_hsp[All_best_var_genes_like_hsp$Assessed_Allele_Freq >= 0.05,])
#look at hsp90
All_best_var_hsp <- All_best_var_genes_like_hsp[grepl('ENSG00000096384', All_best_var_genes_like_hsp$cis_eQTL_id),]
#look at hsp90
All_best_var_hsp <- All_best_var_genes_like_hsp[grepl('ENSG00000096384', All_best_var_genes_like_hsp$cis_eQTL_id),]
rm(list=ls(all=TRUE))
df <- read.csv('../../Body/1_Raw/hsp90_human_tissues_turnover_rate_expression_level.csv')
plot(log10(df$Turnover..days.), log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.), col = 'blue', pch = 19)
text(log10(df$Turnover..days.)+0.1, log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.)+0.02, labels=df$Tissue, cex= 0.7)
cor.test(df$Turnover..days., df$Expression.level.ofHSP90AB1.in.human..TPM..median.)
plot(df$Turnover..days., df$Expression.level.ofHSP90AB1.in.human..TPM..median., col = 'blue', pch = 19)
text(df$Turnover..days.+500, df$Expression.level.ofHSP90AB1.in.human..TPM..median.+32, labels=df$Tissue, cex= 0.7)
pdf('../../Body/4_Figures/hsp90.human.tissues.turnover.rate.expression.level.pdf')
plot(log10(df$Turnover..days.), log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.), col = 'blue', pch = 19)
text(log10(df$Turnover..days.)+0.1, log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.)+0.02, labels=df$Tissue, cex= 0.7)
plot(df$Turnover..days., df$Expression.level.ofHSP90AB1.in.human..TPM..median., col = 'blue', pch = 19)
text(df$Turnover..days.+500, df$Expression.level.ofHSP90AB1.in.human..TPM..median.+32, labels=df$Tissue, cex= 0.7)
dev.off()
cor.test(df$Turnover..days., df$Expression.level.ofHSP90AB1.in.human..TPM..median.)
cor.test(log10(df$Turnover..days.), log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.))
cor.test(log10(df$Turnover..days.), log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.), method = spearman)
cor.test(log10(df$Turnover..days.), log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.), method = 'spearman')
text(log10(df$Turnover..days.)+0.1, log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.)+0.02, labels=df$Tissue, cex= 0.7)
plot(log10(df$Turnover..days.), log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.), col = 'blue', pch = 19)
text(log10(df$Turnover..days.)+0.1, log10(df$Expression.level.ofHSP90AB1.in.human..TPM..median.)+0.02, labels=df$Tissue, cex= 0.7)
